{% extends "datatables.jinja2" %}
{% block scripts %}
  <script type="text/javascript">
    function afterdatatables() {
      {% if writeallowed %}
        var tools = new EditorButtonDialog();
        tools.init("\
            <h3>Import Races</h3>\
            <div>\
              <p>Import the selected year's race list as a CSV file. Please read the <a href='{{url_for("doc_importraces")}}' target='_blank'>Import Guide</a> for information on the column headers and data format.</p>\
              <form id='import-races' method='post' enctype='multipart/form-data'>\
                <input id='choosefileImport' type='file' name='file' />\
                <button id='manageracesImport' _rrwebapp-formaction='{{url_for("_importraces")}}'>Import</button>\
              </form>\
            </div>");
        var btn = _dt_table.button( 'tools:name' );
        tools.position({
                         my: "left top",
                         at: "middle bottom",
                         of: btn.node()
                         });
        btn.action( function( object, dtapi, button, cnf ){
            tools.click();
        } );

        // needs called in afterdatatables because this will use some of the elements created above
        manageraces( {% if writeallowed %}true{% else %}false{% endif %});

      {% endif %}
    }

  </script>
  {{ super() }}

{% endblock %}
